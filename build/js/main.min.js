
window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("#form"),t=e.querySelector("#nights"),n=e.querySelector("#nights-to"),r=e.querySelector("#depart-city"),o=e.querySelector("#country"),i=document.querySelector("#tourTableBody"),a=document.querySelector(".tour-table thead"),c=document.querySelector(".tours__title");function d(e,t){return e.price>t.price?1:e.price<t.price?-1:0}function u(e,t){e.value="",e.setAttribute("placeholder",t),e.classList.add("error")}function l(e){e.classList.remove("error"),e.setAttribute("placeholder","от 5 до 15")}t.addEventListener("input",e=>{const t=e.target;n.value.length>0&&+n.value<=+t.value?u(t,"Больше чем до"):n.value>t.value&&l(t)}),n.addEventListener("change",e=>{const n=e.target;t.value.length>0&&+t.value>=+n.value?u(n,"Меньше чем от"):n.value>t.value&&l(n)}),e.addEventListener("submit",e=>{e.preventDefault();const u=Object.fromEntries(new FormData(e.target).entries()),{departCity:s,country:h,date:p,nights:v,nightsTo:y}=u;(async({departCity:e,country:t,date:n,nights:r,nightsTo:o}={})=>{const i=await fetch(`https://ht.kz/test/searchPartner1?departCity=${e}&country=${t}&date=${n}&nights=${r}&nightsTo=${o}`);return await i.json()})({departCity:s,country:h,date:p,nights:v,nightsTo:y}).then(e=>{const t=e.tours.sort(d);let n=r[r.options.selectedIndex].innerText,u=o[o.options.selectedIndex].innerText,l=new Date(p).toLocaleDateString("lookup",{year:"numeric",month:"long",day:"numeric"}).replace(/г.$/g,"").trim();c.innerHTML=`\n      <h2>\n        Результаты запроса (${n} -\n        ${u},\n        ${l},\n        ${v}-${y}н.):\n      </h2>\n      `,a.innerHTML="\n        <tr>\n          <th>Hotel name</th>\n          <th>price</th>\n          <th>currency</th>\n        </tr>\n      ",t.forEach(e=>{i.innerHTML+=`\n        <tr>\n          <td>${e.hotelName}</td>\n          <td>${e.price}</td>\n          <td>${e.currency}</td>\n        </tr>\n        `,document.querySelector("#tours").classList.add("tours")})}).catch(e=>{throw new Error(`${e.name} ${e.message}`)}).finally(()=>{e.target.reset(),l(t),l(n)})}),r.addEventListener("change",e=>{const t=e.target;t&&"10"===r.value?o.innerHTML='\n      <option value="" disabled selected hidden>Страна</option>\n      <option value="552">Турция</option>\n      <option value="553">Тайланд</option>':t&&"11"===r.value?o.innerHTML='\n      <option value="" disabled selected hidden>Страна</option>\n      <option value="552">Турция</option>\n      <option value="554">Чехия</option>':o.innerHTML='\n      <option value="" disabled selected hidden>Страна</option>\n      <option>Страна</option>\n      '})});
const maxDate=changeDatePickerRange(90),minDate=changeDatePickerRange(1);function changeDatePickerRange(e){return getDate(getMillisecunds(e))}function getDate(e){const t=Date.now()+e,n=new Date(t).getDate(),a=new Date(t).getMonth()+1;return`${new Date(t).getFullYear()}-${getZero(a)}-${getZero(n)}`}function getZero(e){return e>=0&&e<10?"0"+e:e}function setMaxDate(e,t){document.getElementById(e).setAttribute("max",t)}function setMinDate(e,t){document.getElementById(e).setAttribute("min",t)}function getMillisecunds(e){return 864e5*e}setMaxDate("date-input",maxDate),setMinDate("date-input",minDate);
//# sourceMappingURL=../sourcemaps/main.min.js.map
