{"version":3,"sources":["bem-blocks/form.js","server/api.js","01_main.js"],"names":["window","addEventListener","$form","document","querySelector","$nights","$nightsTo","compare","a","b","price","event","target","value","length","undefined","setAttribute","classList","add","remove","e","preventDefault","formData","Object","fromEntries","FormData","entries","departCity","country","date","nights","nightsTo","async","res","fetch","json","getData","then","data","sort","tours","console","log","maxDate","changeDatePickerRange","minDate","days","getDate","getMillisecunds","millisec","t","Date","now","month","getMonth","getFullYear","getZero","num","setMaxDate","selector","getElementById","setMinDate"],"mappings":"AAAA;ACAAA,OAAOC,iBAAiB,mBAAoB,KAC1C,MAAMC,EAAQC,SAASC,cAAc,SAC/BC,EAAUH,EAAME,cAAc,WAC9BE,EAAYJ,EAAME,cAAc,cA+DtC,SAASG,EAAQC,EAAGC,GAClB,OAAID,EAAEE,MAAQD,EAAEC,MACP,EAELF,EAAEE,MAAQD,EAAEC,OACN,EAEH,EArDTL,EAAQJ,iBAAiB,QAAUU,IACjC,MAAMC,EAASD,EAAMC,OAEnBN,EAAUO,MAAMC,OAAS,QACLC,IAApBT,EAAUO,QACTP,EAAUO,QAAUD,EAAOC,QAE5BD,EAAOC,MAAQ,GACfD,EAAOI,aAAa,cAAe,iBACnCJ,EAAOK,UAAUC,IAAI,UAEvBN,EAAOK,UAAUE,OAAO,SACxBP,EAAOI,aAAa,cAAe,MAGrCV,EAAUL,iBAAiB,SAAWU,IACpC,MAAMC,EAASD,EAAMC,OAEnBP,EAAQQ,MAAMC,OAAS,QACLC,IAAlBV,EAAQQ,QACPR,EAAQQ,QAAUD,EAAOC,OAE1BD,EAAOC,MAAQ,GACfD,EAAOI,aAAa,cAAe,iBACnCJ,EAAOK,UAAUC,IAAI,UACZb,EAAQQ,MAAQD,EAAOC,QAChCD,EAAOK,UAAUE,OAAO,SACxBP,EAAOI,aAAa,cAAe,OAKvCd,EAAMD,iBAAiB,SAAWmB,IAChCA,EAAEC,iBAEF,MAAMC,EAAWC,OAAOC,YAAY,IAAIC,SAASL,EAAER,QAAQc,YACrDC,WAAEA,EAAUC,QAAEA,EAAOC,KAAEA,EAAIC,OAAEA,EAAMC,SAAEA,GAAaT,EAlD1CU,QACdL,WAAAA,EACAC,QAAAA,EACAC,KAAAA,EACAC,OAAAA,EACAC,SAAAA,GACE,MACF,MAAME,QAAYC,MAChB,gDAAqBP,aAAsBC,UAAgBC,YAAeC,cAAmBC,KAG/F,aAAaE,EAAIE,QAyCjBC,CAAQ,CAAET,WAAAA,EAAYC,QAAAA,EAASC,KAAAA,EAAMC,OAAAA,EAAQC,SAAAA,IAAYM,KAAMC,IAC7D,MACMC,EADQD,EAAKE,MACAD,KAAKhC,GACxBkC,QAAQC,IAAIH;AC7DlB,MAAMI,QAAUC,sBAAsB,IAChCC,QAAUD,sBAAsB,GAOtC,SAASA,sBAAsBE,GAG7B,OADaC,QADIC,gBAAgBF,IAKnC,SAASC,QAAQE,GACf,MAAMC,EAAIC,KAAKC,MAAQH,EACrBH,EAAO,IAAIK,KAAKD,GAAGH,UACnBM,EAAQ,IAAIF,KAAKD,GAAGI,WAAa,EAKnC,MAFa,GAFJ,IAAIH,KAAKD,GAAGK,iBAEGC,QAAQH,MAAUG,QAAQV,KAKpD,SAASU,QAAQC,GACf,OAAIA,GAAO,GAAKA,EAAM,GACb,IAAMA,EAENA,EAIX,SAASC,WAAWC,EAAU9B,GAC5B1B,SAASyD,eAAeD,GAAU3C,aAAa,MAAOa,GAExD,SAASgC,WAAWF,EAAU9B,GAC5B1B,SAASyD,eAAeD,GAAU3C,aAAa,MAAOa,GAGxD,SAASmB,gBAAgBF,GAEvB,OADY,MAAsBA,EAtCpCY,WAAW,aAAcf,SACzBkB,WAAW,aAAchB","file":"../components/main.min.js","sourcesContent":["","window.addEventListener(\"DOMContentLoaded\", () => {\r\n  const $form = document.querySelector(\"#form\");\r\n  const $nights = $form.querySelector(\"#nights\");\r\n  const $nightsTo = $form.querySelector(\"#nights-to\");\r\n  const URL = \"https://ht.kz/test/searchPartner1\";\r\n\r\n  const getData = async ({\r\n    departCity,\r\n    country,\r\n    date,\r\n    nights,\r\n    nightsTo,\r\n  } = {}) => {\r\n    const res = await fetch(\r\n      `${URL}?departCity=${departCity}&country=${country}&date=${date}&nights=${nights}&nightsTo=${nightsTo}`\r\n    );\r\n\r\n    return await res.json();\r\n  };\r\n\r\n  $nights.addEventListener(\"input\", (event) => {\r\n    const target = event.target;\r\n    if (\r\n      $nightsTo.value.length > 0 &&\r\n      $nightsTo.value !== undefined &&\r\n      +$nightsTo.value <= +target.value\r\n    ) {\r\n      target.value = \"\";\r\n      target.setAttribute(\"placeholder\", \"Больше чем до\");\r\n      target.classList.add(\"error\");\r\n    }\r\n    target.classList.remove(\"error\");\r\n    target.setAttribute(\"placeholder\", \"\");\r\n  });\r\n\r\n  $nightsTo.addEventListener(\"change\", (event) => {\r\n    const target = event.target;\r\n    if (\r\n      $nights.value.length > 0 &&\r\n      $nights.value !== undefined &&\r\n      +$nights.value >= +target.value\r\n    ) {\r\n      target.value = \"\";\r\n      target.setAttribute(\"placeholder\", \"Меньше чем от\");\r\n      target.classList.add(\"error\");\r\n    } else if ($nights.value < target.value) {\r\n      target.classList.remove(\"error\");\r\n      target.setAttribute(\"placeholder\", \"\");\r\n    }\r\n  });\r\n\r\n  /* FORM GET */\r\n  $form.addEventListener(\"submit\", (e) => {\r\n    e.preventDefault();\r\n\r\n    const formData = Object.fromEntries(new FormData(e.target).entries());\r\n    const { departCity, country, date, nights, nightsTo } = formData;\r\n\r\n    getData({ departCity, country, date, nights, nightsTo }).then((data) => {\r\n      const tours = data.tours;\r\n      const sort = tours.sort(compare);\r\n      console.log(sort)\r\n    });\r\n  });\r\n\r\n\r\n  function compare(a, b) {\r\n    if (a.price > b.price) {\r\n      return 1;\r\n    }\r\n    if (a.price < b.price) {\r\n      return -1;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  // function inputError(e, message) {\r\n  //   const target = e.target;\r\n  //   target.value = \"\";\r\n  //   target.setAttribute(\"placeholder\", message);\r\n  //   target.classList.add(\"error\");\r\n  // }\r\n\r\n  // function removeErrorClass(e) {\r\n  //   const target = e.target;\r\n  //   target.classList.remove(\"error\");\r\n  //   target.setAttribute(\"placeholder\", \"\");\r\n  // }\r\n});\r\n","const maxDate = changeDatePickerRange(90);\r\nconst minDate = changeDatePickerRange(1);\r\n\r\nsetMaxDate(\"date-input\", maxDate);\r\nsetMinDate(\"date-input\", minDate);\r\n\r\n/* ============= functions =============== */\r\n\r\nfunction changeDatePickerRange(days) {\r\n  const millesec = getMillisecunds(days);\r\n  const date = getDate(millesec);\r\n  return date;\r\n}\r\n\r\nfunction getDate(millisec) {\r\n  const t = Date.now() + millisec,\r\n    days = new Date(t).getDate(),\r\n    month = new Date(t).getMonth() + 1,\r\n    year = new Date(t).getFullYear();\r\n\r\n  const date = `${year}-${getZero(month)}-${getZero(days)}`;\r\n\r\n  return date;\r\n}\r\n\r\nfunction getZero(num) {\r\n  if (num >= 0 && num < 10) {\r\n    return \"0\" + num;\r\n  } else {\r\n    return num;\r\n  }\r\n}\r\n\r\nfunction setMaxDate(selector, date) {\r\n  document.getElementById(selector).setAttribute(\"max\", date);\r\n}\r\nfunction setMinDate(selector, date) {\r\n  document.getElementById(selector).setAttribute(\"min\", date);\r\n}\r\n\r\nfunction getMillisecunds(days) {\r\n  const mil = 1000 * 60 * 60 * 24 * days;\r\n  return mil;\r\n}\r\n\r\n// function createNode(element, className, message) {\r\n//   const div = document.createElement(element);\r\n//   div.classList.add(className);\r\n//   div.textContent = message;\r\n//   return div;\r\n// }\r\n\r\n// function append(parent, el) {\r\n//   return parent.append(el);\r\n// }\r\n"]}